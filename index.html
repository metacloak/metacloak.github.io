<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Toward Robust Imperceptible Perturbation against Unauthorized Text-to-image Diffusion-based Synthesis.">
  <meta name="keywords" content="Real3D-Portrait, One-shot, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Toward Robust Imperceptible Perturbation against Unauthorized Text-to-image Diffusion-based Synthesis </title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/3dface_logo.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Metacloak: Toward Robust Imperceptible Perturbation against Unauthorized Text-to-image Diffusion-based Synthesis</h1>
            <h3 class="title is-5"> CVPR 2024 Oral Presentation </h3>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="mailto:yila22@lehigh.edu">Yixin Liu</a><sup>1,3</sup>,
              </span>
              <span class="author-block">
                <a href="mailto:fancr0422@gmail.com">Chenrui Fan</a><sup>2</sup>,
              </span>
              <span class="author-block">
                <a href="mailto:yud319@lehigh.edu">Yutong Dai</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a href="mailto:Xun.chen@samsung.com">Xun Chen</a><sup>3</sup>,
              </span>
              <span class="author-block">
                <a href="mailto:panzhou@hust.edu.cn">Pan Zhou</a><sup>2</sup>,
              </span>
              <span class="author-block">
                <a href="mailto:lis221@lehigh.edu">Lichao Sun</a><sup>1</sup>
              </span>
            </div>
            
            <div class="is-size-5 publication-authors">
              <span class="author-block"><sup>1</sup>Lehigh University,</span>
              <span class="author-block"><sup>2</sup>Huazhong University of Science and Technology,</span>
              <span class="author-block"><sup>3</sup>Samsung Research American</span>
            </div>
            
            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                </span>
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2311.13127" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <!-- Code Link. -->
                  <!-- Code Link. -->
                <span class="link-block">
                  <a href="https://github.com/liuyixin-louis/MetaCloak" class="external-link button is-normal is-rounded is-dark" onclick="">
                  <span class="icon">
                  <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github"></i> Font Awesome fontawesome.com -->
                  </span>
                  <span>Code</span>
                  </a>
                </span>
                <!-- Dataset Link. -->
                <span class="link-block">
                  <a href="https://huggingface.co/datasets/yixin/metacloak_celeba_vggface2" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <svg class="svg-inline--fa fa-images fa-w-18" aria-hidden="true" focusable="false" data-prefix="far" data-icon="images" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M480 416v16c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V176c0-26.51 21.49-48 48-48h16v48H54a6 6 0 0 0-6 6v244a6 6 0 0 0 6 6h372a6 6 0 0 0 6-6v-10h48zm42-336H150a6 6 0 0 0-6 6v244a6 6 0 0 0 6 6h372a6 6 0 0 0 6-6V86a6 6 0 0 0-6-6zm6-48c26.51 0 48 21.49 48 48v256c0 26.51-21.49 48-48 48H144c-26.51 0-48-21.49-48-48V80c0-26.51 21.49-48 48-48h384zM264 144c0 22.091-17.909 40-40 40s-40-17.909-40-40 17.909-40 40-40 40 17.909 40 40zm-72 96l39.515-39.515c4.686-4.686 12.284-4.686 16.971 0L288 240l103.515-103.515c4.686-4.686 12.284-4.686 16.971 0L480 208v80H192v-48z"></path></svg>
                    </span>
                    <span>Dataset</span>
                    </a>
              </span></div>
  
            </div>
            
          </div>
        </div>

            <!-- Abstract. -->
            <div class="container is-max-desktop">
              <div class="columns is-centered has-text-centered">
                <div class="column is-four-fifths">
                  <!-- <img src="./static/images/teaser.png"
        class="interpolation-image"
        alt="The overall algorithm of MetaCloak."/> -->
        <div class="column has-text-centered">
          <h2 class="title is-3">Presentation Video</h2>
          <iframe width="560" height="315" src="https://www.youtube.com/embed/-oqm1lHglmk?si=-yUtPV37rC2zRi0F" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>        
        
                  <h2 class="title is-3">Abstract</h2>
                  <div class="content has-text-justified">
                    <p>
                      Text-to-image diffusion models have revolutionized the way we generate personalized images from minimal reference photos. However, when misused, these tools can create misleading or harmful content, posing a significant risk to individuals. Current methods attempt to mitigate this by subtly altering user images to make them ineffective for unauthorized use. However, these poisoning-based defenses often fall short due to reliance on simplistic heuristics and a lack of resilience against basic image transformations like Gaussian filtering.
                    </p>
                    <p>
                      To combat these shortcomings, we introduce <u><b>MetaCloak</b></u>, an innovative approach that leverages a meta-learning framework to tackle the bi-level poisoning challenge. MetaCloak not only addresses the limitations of previous methods by incorporating a transformation sampling process for crafting robust and transferable perturbations but also utilizes a pool of surrogate diffusion models to ensure these perturbations are model-agnostic. An additional layer of innovation is applied in the form of a denoising-error maximization loss, designed to induce semantic distortion resilient to transformations, thus enhancing the generation's personalized touch.
                    </p>
                    <p>
                      Our comprehensive tests across the VGGFace2 and CelebA-HQ datasets demonstrate MetaCloak's superior performance over existing solutions. Remarkably, MetaCloak can deceive online training platforms like Replicate in a black-box fashion, showcasing its practical effectiveness in real-world applications. For those interested in further exploration or application, our code is publicly available at <a href="https://github.com/liuyixin-louis/MetaCloak">https://github.com/liuyixin-louis/MetaCloak</a>.
                    </p>
                  </div>                  
                </div>
              </div>
            </div>
      <!--/ Abstract. -->
      
      <br></br>
      <div class="column has-text-centered">
      <h2 class="title is-3">Overall Algorithm</h2>
        The algorithm of <b>MetaCloak</b> is shown as follows:
        <img src="./static/images/framework.png"
        class="interpolation-image"
        alt="The overall algorithm of MetaCloak."/>
      </div>
    </div>
    </div>
  </section>

<!-- <section class="section"> -->
  <div class="container is-max-desktop">

          <h1 class="title is-3">Main Results on Effectiveness</h1>
          <div class="content has-text-justified">
            <p>
              Our experiments are performed on human subjects using the two face datasets: Celeba-HQ and VGGFace  following Anti-DreamBooth. CelebA-HQ is an enhanced version of the original CelebA dataset consisting of 30,000 celebrity face images.VGGFace2 is a comprehensive dataset with over 3.3 million face images from 9,131 unique identities. Fifty identities are selected from each dataset, and we randomly pick 8 images from each individual and split those images into two subsets for image protection and reference. 
              To show the overall performance of <b><u>MetaCloak</u></b>, in the following, we provide the main results of our method quantitatively and qualitatively.
            </p>
          </div>
          <div class="content has-text-centered">
            <img src="./static/images/table1-main.jpg"> 
            <img src="./static/images/figure2-main.jpg"> 
          </div>

          <h1 class="title is-3">Robustness against purifications</h1>
          <div class="content has-text-justified">
            <p>
              We consider three adversarial purification techniques, including JPEG compression super-resolution transformation (SR), and image reconstruction based on total-variation minimization (TVM). We use a quality factor of 75 for the JPEG defense and a scale factor of 4 for the SR defense.  
            </p>
          </div>
          <div class="content has-text-centered">
            <img src="./static/images/table4-robust.jpg"> 
          </div>

        <!-- Effectiveness under Online Training-as-services Scenarios -->
        <h1 class="title is-3">Effectiveness under Online Training-as-services Scenarios</h1>
        <div class="content has-text-justified">
          <p>
            To test the effectiveness of our framework in the wild, we conduct experiments under online training-as-service settings. Unlike local training, attacking online training services is more challenging due to the limited knowledge of data prepossessing. We first showcase the performance of our method under two common DreamBooth fine-tuning scenarios, including full fine-tuning (Full-FT) and LoRA-fine-tuning (LoRA-FT). We sample data from VGGFace2 and upload its clean and poisoned images to Replicate for DreamBooth training. 
          </p>
        </div>
        <div class="content has-text-centered">
          <img src="./static/images/figure3-replicate.jpg"> 
        </div>
                      
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@InProceedings{Liu_2024_CVPR,
          author    = {Liu, Yixin and Fan, Chenrui and Dai, Yutong and Chen, Xun and Zhou, Pan and Sun, Lichao},
          title     = {MetaCloak: Preventing Unauthorized Subject-driven Text-to-image Diffusion-based Synthesis via Meta-learning},
          booktitle = {Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)},
          month     = {June},
          year      = {2024},
          pages     = {24219-24228}
      }</code></pre>
    </div>
  </section>


  <section class="section" id="Acknowledgements">
    <div class="container is-max-desktop content">
      <h2 class="title">Acknowledgements</h2>
      <p>
        We thank the project homepage template from <a href="https://real3dportrait.github.io">Real3D-Portrait</a> and <a href="https://anti-dreambooth.github.io"> Anti-DreamBooth</a>. And we also thank Stability AI, RunwayML and CompVis for publishing different version of pretrained Stable Diffusion models.
      </p>
    </div>
         

</body>
</html>
